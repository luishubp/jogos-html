<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>FNAF Remastered - Fix V3.1</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root { --primary-color: #88ff88; }
        body { margin: 0; background: #000; color: #fff; font-family: 'VT323', monospace; overflow: hidden; display: flex; justify-content: center; align-items: center; height: 100vh; }
        #game-container { position: relative; width: 100vw; height: 56.25vw; max-width: 1280px; max-height: 720px; border: 2px solid #333; overflow: hidden; background: #050505; }

        /* ESCRITÓRIO */
        #office { width: 100%; height: 100%; position: relative; background: #1a1a1a; }
        
        /* PORTAS */
        .physical-door { position: absolute; top: -100%; width: 12%; height: 100%; background: #333; border: 2px solid #111; transition: top 0.3s ease-in; z-index: 40; }
        .door-left { left: 8%; }
        .door-right { right: 8%; }
        .door-closed { top: 0% !important; }

        /* LUZES - Efeito de claridade */
        .light-effect { position: absolute; width: 35%; height: 100%; opacity: 0; pointer-events: none; z-index: 20; transition: opacity 0.1s; }
        #light-L { left: 0; background: radial-gradient(circle at 0% 50%, rgba(255,255,255,0.4), transparent); }
        #light-R { right: 0; background: radial-gradient(circle at 100% 50%, rgba(255,255,255,0.4), transparent); }

        /* APARECER NA PORTA (Sombra do Animatronic) */
        .enemy-at-door { position: absolute; width: 100px; height: 250px; bottom: 10%; z-index: 15; filter: brightness(0.2) blur(2px); display: none; }
        #bonnie-door { left: 2%; background: purple; border-radius: 50% 50% 0 0; }
        #chica-door { right: 2%; background: yellow; border-radius: 50% 50% 0 0; }

        /* PAINÉIS */
        .control-panel { position: absolute; top: 30%; width: 60px; height: 160px; background: #222; display: flex; flex-direction: column; align-items: center; justify-content: space-around; z-index: 100; }
        .panel-left { left: 0; } .panel-right { right: 0; }
        .btn { width: 45px; height: 45px; border-radius: 50%; cursor: pointer; border: 2px solid #000; text-align: center; line-height: 45px; font-size: 10px; }
        .active-door { background: #f00 !important; }
        .active-light { background: #ff0 !important; color: #000; }

        /* MONITOR */
        #camera-tablet { position: absolute; inset: 0; background: #000; display: none; z-index: 500; }
        .cam-btn { background: #003300; color: white; padding: 10px; cursor: pointer; border: 1px solid var(--primary-color); }
        .cam-btn.active { background: var(--primary-color); color: black; }

        /* UI */
        .ui { position: absolute; z-index: 1000; color: var(--primary-color); font-size: 24px; }
        #monitor-trigger { bottom: 0; left: 30%; width: 40%; height: 40px; background: rgba(255,255,255,0.2); text-align: center; line-height: 40px; cursor: pointer; color: white; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="office">
        <div id="bonnie-door" class="enemy-at-door"></div>
        <div id="chica-door" class="enemy-at-door"></div>

        <div id="light-L" class="light-effect"></div>
        <div id="light-R" class="light-effect"></div>

        <div id="visual-door-L" class="physical-door door-left"></div>
        <div id="visual-door-R" class="physical-door door-right"></div>
        
        <div class="control-panel panel-left">
            <div id="btn-L-door" class="btn" style="background:#400" onclick="game.toggleDoor('left')">DOOR</div>
            <div id="btn-L-light" class="btn" style="background:#440" onmousedown="game.setLight('left',true)" onmouseup="game.setLight('left',false)">LIT</div>
        </div>
        <div class="control-panel panel-right">
            <div id="btn-R-door" class="btn" style="background:#400" onclick="game.toggleDoor('right')">DOOR</div>
            <div id="btn-R-light" class="btn" style="background:#440" onmousedown="game.setLight('right',true)" onmouseup="game.setLight('right',false)">LIT</div>
        </div>
    </div>

    <div id="camera-tablet">
        <div style="padding: 20px;">
            <div id="cam-view" style="width:100%; height:300px; background:#111; position:relative; display:flex; justify-content:center; align-items:center;">
                <div id="enemy-dot" style="width:50px; height:50px; border-radius:50%; display:none;"></div>
                <h2 id="cam-name" style="position:absolute; top:10px; left:10px;">CAM 1A</h2>
            </div>
            <div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:20px;">
                <button class="cam-btn" onclick="game.switchCam('1A')">1A (Bonnie/Chica)</button>
                <button class="cam-btn" onclick="game.switchCam('1B')">1B (Chica)</button>
                <button class="cam-btn" onclick="game.switchCam('2A')">2A (Bonnie)</button>
                <button class="cam-btn" onclick="game.switchCam('4B')">4B (Chica)</button>
            </div>
        </div>
    </div>

    <div class="ui" style="bottom:10px; left:10px;">ENERGIA: <span id="pwr-val">100</span>%</div>
    <div class="ui" style="top:10px; right:10px; font-size:40px;" id="clock-val">12 AM</div>
    <div id="monitor-trigger" onclick="game.toggleMonitor()">MONITOR</div>
</div>

<script>
class FNAFGame {
    constructor() {
        this.power = 100;
        this.currentCam = '1A';
        this.monitorOpen = false;
        this.doors = { left: false, right: false };
        this.lights = { left: false, right: false };
        this.enemies = {
            'Bonnie': { pos: '1A', color: 'purple', path: ['1A', '2A', 'DoorL'], home: '1A' },
            'Chica': { pos: '1A', color: 'yellow', path: ['1A', '1B', '4B', 'DoorR'], home: '1A' }
        };
        this.startTimers();
    }

    startTimers() {
        setInterval(() => this.tick(), 1000);
        setInterval(() => this.moveAI(), 5000); // Tenta mover a cada 5 segundos
    }

    tick() {
        let drain = 0.1;
        if(this.doors.left) drain += 0.3;
        if(this.doors.right) drain += 0.3;
        if(this.lights.left || this.lights.right) drain += 0.2;
        if(this.monitorOpen) drain += 0.2;
        
        this.power -= drain;
        document.getElementById('pwr-val').innerText = Math.floor(this.power);
        if(this.power <= 0) location.reload();
    }

    toggleDoor(side) {
        this.doors[side] = !this.doors[side];
        document.getElementById(`visual-door-${side==='left'?'L':'R'}`).classList.toggle('door-closed', this.doors[side]);
        document.getElementById(`btn-${side==='left'?'L':'R'}-door`).classList.toggle('active-door', this.doors[side]);
    }

    setLight(side, state) {
        this.lights[side] = state;
        document.getElementById(`light-${side==='left'?'L':'R'}`).style.opacity = state ? 1 : 0;
        document.getElementById(`btn-${side==='left'?'L':'R'}-light`).classList.toggle('active-light', state);
        this.checkLightVisibility();
    }

    checkLightVisibility() {
        // Se a luz esquerda está acesa e Bonnie está na DoorL
        const bonnieInDoor = this.enemies['Bonnie'].pos === 'DoorL';
        document.getElementById('bonnie-door').style.display = (this.lights.left && bonnieInDoor) ? 'block' : 'none';

        // Se a luz direita está acesa e Chica está na DoorR
        const chicaInDoor = this.enemies['Chica'].pos === 'DoorR';
        document.getElementById('chica-door').style.display = (this.lights.right && chicaInDoor) ? 'block' : 'none';
    }

    moveAI() {
        for (let name in this.enemies) {
            let e = this.enemies[name];
            if (Math.random() > 0.5) {
                let idx = e.path.indexOf(e.pos);
                
                // Se chegou na porta
                if (e.pos === 'DoorL' || e.pos === 'DoorR') {
                    let side = e.pos === 'DoorL' ? 'left' : 'right';
                    if (this.doors[side]) {
                        e.pos = e.home; // Porta fechada, volta pro início
                    } else {
                        alert("JUMPSCARE: " + name); location.reload();
                    }
                } else if (idx < e.path.length - 1) {
                    e.pos = e.path[idx + 1];
                }
            }
        }
        this.updateCamUI();
        this.checkLightVisibility();
    }

    toggleMonitor() {
        this.monitorOpen = !this.monitorOpen;
        document.getElementById('camera-tablet').style.display = this.monitorOpen ? 'block' : 'none';
        if(this.monitorOpen) this.updateCamUI();
    }

    switchCam(cam) {
        this.currentCam = cam;
        document.getElementById('cam-name').innerText = "CAM " + cam;
        this.updateCamUI();
    }

    updateCamUI() {
        const dot = document.getElementById('enemy-dot');
        dot.style.display = 'none';
        for (let name in this.enemies) {
            if (this.enemies[name].pos === this.currentCam) {
                dot.style.display = 'block';
                dot.style.background = this.enemies[name].color;
            }
        }
    }
}
const game = new FNAFGame();
</script>
</body>
</html>

