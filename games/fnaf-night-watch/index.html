<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FNAF: Ultimate Mobile Edition</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
<style>
body {
    margin: 0;
    background: #000;
    color: #fff;
    font-family: 'VT323', monospace;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}
#screen-container {
    position: relative;
    width: 1000px;
    height: 600px;
    background: #0a0a0a;
    border: 10px solid #333;
    overflow: hidden;
}
#office { position:absolute; inset:0; }
.door {
    position:absolute; top:0; width:120px; height:100%;
    background:#222; z-index:50;
    transform:translateY(-100%);
}
.closed { transform:translateY(0); }
#door-L{left:0;} #door-R{right:0;}
.light-effect{
    position:absolute; top:0; width:300px; height:100%;
    opacity:0; pointer-events:none; z-index:40;
}
#light-L{left:0;} #light-R{right:0;}
.side-panel{
    position:absolute; top:35%; z-index:100;
    background:#222; padding:10px;
}
.btn{width:60px;height:40px;cursor:pointer;}
#camera-monitor{
    position:absolute; inset:0; background:#000;
    display:none; z-index:500;
}
#animatronic-visual{
    position:absolute; font-size:150px;
    display:none;
}
#ui{position:absolute; bottom:20px; left:20px;}
#monitor-trigger{
    position:absolute; bottom:0; left:30%;
    width:40%; height:40px; cursor:pointer;
}
#clock-container{
    position:absolute; top:10px; right:10px;
}
#menu{
    position:absolute; inset:0;
    background:rgba(0,0,0,.9);
    display:flex; flex-direction:column;
    align-items:center; justify-content:center;
    z-index:2000;
}
.menu-btn{margin:10px; padding:15px 40px;}
#jumpscare-overlay{
    position:fixed; inset:0; background:#000;
    display:none; z-index:9999;
    justify-content:center; align-items:center;
}
</style>
</head>
<body>

<div id="screen-container">
    <div id="office">
        <div id="door-L" class="door"></div>
        <div id="door-R" class="door"></div>
        <div id="light-L" class="light-effect"></div>
        <div id="light-R" class="light-effect"></div>
    </div>

    <div id="camera-monitor">
        <div id="animatronic-visual"></div>
    </div>

    <div id="ui">
        POWER: <span id="pwr-val">100</span>%<br>
        USAGE: <span id="usage-val">1</span>
    </div>

    <div id="monitor-trigger">MONITOR</div>

    <div id="clock-container">
        <div id="clock">12:00 AM</div>
        <div id="night">night 1</div>
    </div>

    <div id="menu">
        <button id="new-game" class="menu-btn">New Game</button>
        <button id="continue-game" class="menu-btn">Continue</button>
    </div>

    <div id="jumpscare-overlay">
        <div id="scare-char" style="font-size:300px;">üêª</div>
    </div>
</div>

<script>
class FNAF {
    constructor() {
        const saved = JSON.parse(localStorage.getItem('fnafSave'));
        this.pwr = saved?.pwr ?? 100;
        this.cam = saved?.cam ?? '1A';
        this.doors = saved?.doors ?? {L:false,R:false};
        this.lights = saved?.lights ?? {L:false,R:false};
        this.foxyProgress = saved?.foxyProgress ?? 0;
        this.hour = saved?.hour ?? 12;
        this.nightNum = saved?.nightNum ?? 1;

        this.mon = false;
        this.entities = {
            Bonnie:{pos:'1A',path:['1A','1B','5','2A','2B','DOOR'],chance:0.07},
            Chica:{pos:'1A',path:['1A','1B','7','4A','4B','DOOR'],chance:0.06},
            Freddy:{pos:'1A',path:['1A','1B','7','4A','4B','DOOR'],chance:0.04}
        };

        this.setupMenu();
        this.updateUI();
    }

    start(){
        this.energyInterval=setInterval(()=>{
            let use=1+(this.doors.L?1:0)+(this.doors.R?1:0)+(this.mon?1:0);
            this.pwr-=0.1*use;
            if(this.pwr<=0){ this.pwr=0; this.jumpscare('Freddy'); }
            this.updateUI();
            this.save();
        },1000);

        this.aiInterval=setInterval(()=>this.aiTick(),6000);

        this.clockInterval=setInterval(()=>{
            this.hour++;
            if(this.hour===6) this.winNight();
            this.updateUI();
        },45000);
    }

    updateUI(){
        document.getElementById('pwr-val').innerText=Math.floor(this.pwr);
        document.getElementById('usage-val').innerText=1;
        document.getElementById('clock').innerText=`${this.hour}:00 AM`;
        document.getElementById('night').innerText=`night ${this.nightNum}`;
    }

    aiTick(){
        for(let k of ['Bonnie','Chica','Freddy']){
            let e=this.entities[k];
            if(Math.random()<e.chance){
                let i=e.path.indexOf(e.pos);
                if(i<e.path.length-1) e.pos=e.path[i+1];
                else{
                    let side=k==='Bonnie'?'L':'R';
                    if(!this.doors[side]) this.jumpscare(k);
                    else e.pos='1A';
                }
            }
        }
        this.updateCam();
    }

    updateCam(){
        let d=document.getElementById('animatronic-visual');
        d.style.display='none';
        for(let k of ['Bonnie','Chica','Freddy']){
            if(this.entities[k].pos===this.cam){
                d.style.display='block';
                d.innerText=k==='Bonnie'?'üê∞':k==='Chica'?'üê•':'üêª';
                break;
            }
        }
    }

    jumpscare(who){
        clearInterval(this.energyInterval);
        clearInterval(this.aiInterval);
        clearInterval(this.clockInterval);
        localStorage.removeItem('fnafSave');
        document.getElementById('jumpscare-overlay').style.display='flex';
        document.getElementById('scare-char').innerText=
            who==='Bonnie'?'üê∞':who==='Chica'?'üê•':'üêª';
        setTimeout(()=>location.reload(),2000);
    }

    winNight(){
        alert(`Voc√™ sobreviveu √† Night ${this.nightNum}`);
        this.nightNum++;
        this.hour=12;
        this.save(true);
        location.reload();
    }

    save(reset=false){
        if(reset) localStorage.removeItem('fnafSave');
        else localStorage.setItem('fnafSave',JSON.stringify(this));
    }

    setupMenu(){
        document.getElementById('new-game').onclick=()=>{
            localStorage.removeItem('fnafSave');
            document.getElementById('menu').style.display='none';
            this.start();
        };
        document.getElementById('continue-game').onclick=()=>{
            document.getElementById('menu').style.display='none';
            this.start();
        };
    }
}
const game=new FNAF();
</script>
</body>
</html>
