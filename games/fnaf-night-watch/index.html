<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>FNAF: Ultimate Mobile Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: 'VT323', monospace; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        
        #screen-container { 
            position: relative; width: 1000px; height: 600px; 
            background: #0a0a0a; border: 10px solid #333; overflow: hidden;
            box-shadow: inset 0 0 100px #000;
        }

        /* ESCRITÓRIO */
        #office { position: absolute; inset: 0; background: #1a1a1a; display: flex; justify-content: space-between; align-items: center; }

        /* PORTAS */
        .door { position: absolute; top: 0; width: 120px; height: 100%; background: #222; z-index: 50; transition: 0.2s ease-in; border: 4px solid #111; }
        #door-L { left: 0; transform: translateY(-100%); }
        #door-R { right: 0; transform: translateY(-100%); }
        .closed { transform: translateY(0) !important; }

        /* LUZES */
        .light-effect { position: absolute; top: 0; width: 300px; height: 100%; opacity: 0; pointer-events: none; z-index: 40; }
        #light-L { left: 0; background: linear-gradient(to right, rgba(255,255,200,0.2), transparent); }
        #light-R { right: 0; background: linear-gradient(to left, rgba(255,255,200,0.2), transparent); }

        /* BOTÕES */
        .side-panel { position: absolute; top: 35%; display: flex; flex-direction: column; gap: 15px; z-index: 100; padding: 10px; background: #222; border: 2px solid #444; }
        .btn { width: 70px; height: 50px; cursor: pointer; background: #000; color: #fff; border: 2px solid #fff; font-family: 'VT323'; font-size: 18px; }

        /* MONITOR */
        #camera-monitor { position: absolute; inset: 0; background: #000; z-index: 500; display: none; }
        #cam-view { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; position: relative; }
        #cam-image { height: 100%; object-fit: contain; }
        #static { position: absolute; inset: 0; background: url('https://media.giphy.com/media/oEI9uWUuW9nNe/giphy.gif'); opacity: 0.15; pointer-events: none; }
        
        /* MAPA */
        #map { position: absolute; bottom: 20px; right: 20px; width: 250px; height: 200px; background: rgba(0,0,0,0.9); border: 2px solid #fff; z-index: 600; }
        .cam-btn { position: absolute; width: 45px; height: 30px; background: #333; border: 1px solid #fff; color: #fff; font-size: 14px; cursor: pointer; }
        .cam-btn.active { background: #0f0; color: #000; }

        /* JUMPSCARE */
        #jumpscare-overlay { 
            position: fixed; inset: 0; background: #000; z-index: 9999; 
            display: none; align-items: center; justify-content: center;
            animation: shake 0.1s infinite;
        }
        #scare-img { height: 100%; object-fit: contain; }
        @keyframes shake { 0% { transform: translate(10px, 10px); } 50% { transform: translate(-10px, -10px); } }

        /* UI */
        #ui-pwr { position: absolute; bottom: 20px; left: 20px; z-index: 1000; font-size: 24px; }
        #ui-time { position: absolute; top: 20px; right: 20px; z-index: 1000; font-size: 32px; text-align: right; }
        #monitor-trigger { position: absolute; bottom: 0; left: 30%; width: 40%; height: 40px; background: rgba(255,255,255,0.1); border-top: 2px solid #fff; z-index: 1100; cursor: pointer; color: #fff; text-align: center; line-height: 40px; }
        
        /* ANIMA NA PORTA */
        .door-anim { position: absolute; height: 70%; bottom: 0; display: none; z-index: 45; }
    </style>
</head>
<body>

<div id="screen-container">
    <div id="office">
        <img id="visual-L" class="door-anim" src="bonnie.png" style="left: 0;">
        <img id="visual-R" class="door-anim" src="chica.png" style="right: 0;">

        <div id="door-L" class="door"></div>
        <div id="light-L" class="light-effect"></div>
        
        <div class="side-panel" style="left: 130px;">
            <button class="btn" onclick="game.toggleDoor('L')">DOOR</button>
            <button class="btn" onclick="game.toggleLight('L')">LIGHT</button>
        </div>

        <div id="door-R" class="door"></div>
        <div id="light-R" class="light-effect"></div>

        <div class="side-panel" style="right: 130px;">
            <button class="btn" onclick="game.toggleDoor('R')">DOOR</button>
            <button class="btn" onclick="game.toggleLight('R')">LIGHT</button>
        </div>
    </div>

    <div id="camera-monitor">
        <div id="cam-view">
            <img id="cam-image" src="">
            <div id="static"></div>
            <div id="map">
                <button class="cam-btn active" style="top:10px; left:40%" onclick="game.setCam('1A', this)">1A</button>
                <button class="cam-btn" style="top:40px; left:35%" onclick="game.setCam('1B', this)">1B</button>
                <button class="cam-btn" style="top:90px; left:5%" onclick="game.setCam('1C', this)">1C</button>
                <button class="cam-btn" style="top:40px; left:5%" onclick="game.setCam('5', this)">5</button>
                <button class="cam-btn" style="top:50px; right:5%" onclick="game.setCam('7', this)">7</button>
                <button class="cam-btn" style="bottom:60px; left:25%" onclick="game.setCam('2A', this)">2A</button>
                <button class="cam-btn" style="bottom:20px; left:25%" onclick="game.setCam('2B', this)">2B</button>
                <button class="cam-btn" style="bottom:60px; right:25%" onclick="game.setCam('4A', this)">4A</button>
                <button class="cam-btn" style="bottom:20px; right:25%" onclick="game.setCam('4B', this)">4B</button>
            </div>
        </div>
    </div>

    <div id="ui-pwr">POWER: <span id="pwr-val">100</span>% <br> USAGE: <span id="usage-val">1</span></div>
    <div id="ui-time"><span id="hour-val">12</span> AM <br> <small>NIGHT 1</small></div>

    <div id="monitor-trigger" onclick="game.toggleMonitor()">MONITOR</div>
</div>

<div id="jumpscare-overlay">
    <img id="scare-img" src="">
</div>

<script>
class FNAF {
    constructor() {
        this.pwr = 100;
        this.mon = false;
        this.cam = '1A';
        this.hour = 0; // 0 = 12AM
        this.doors = { L: false, R: false };
        this.lights = { L: false, R: false };
        
        this.foxyStage = 0; // 0: Calmo, 4: Correndo
        this.freddyLocked = false;

        this.entities = {
            'Bonnie': { pos: '1A', path: ['1A','1B','5','2A','2B','OFFICE'], img: 'bonnie.png' },
            'Chica': { pos: '1A', path: ['1A','1B','7','4A','4B','OFFICE'], img: 'chica.png' },
            'Freddy': { pos: '1A', path: ['1A','1B','7','4A','4B','OFFICE'], img: 'freddy.png' }
        };

        this.start();
    }

    start() {
        // Ciclo de Energia
        setInterval(() => {
            let use = 1 + (this.doors.L?1:0) + (this.doors.R?1:0) + (this.mon?1:0) + (this.lights.L||this.lights.R?1:0);
            this.pwr -= (use * 0.12);
            document.getElementById('pwr-val').innerText = Math.floor(this.pwr);
            document.getElementById('usage-val').innerText = use;
            if(this.pwr <= 0) this.jumpscare('freddy.png');
        }, 1000);

        // Ciclo de Horas (45 seg por hora)
        setInterval(() => {
            this.hour++;
            if(this.hour > 6) { alert("6 AM - VOCÊ VENCEU!"); location.reload(); }
            document.getElementById('hour-val').innerText = this.hour === 0 ? 12 : this.hour;
        }, 45000);

        // IA Tick
        setInterval(() => this.aiTick(), 5000);
    }

    toggleDoor(s) { 
        this.doors[s] = !this.doors[s]; 
        document.getElementById(`door-${s}`).classList.toggle('closed', this.doors[s]);
    }

    toggleLight(s) {
        this.lights[s] = !this.lights[s];
        document.getElementById(`light-${s}`).style.opacity = this.lights[s] ? 1 : 0;
        this.updateOfficeEnemies();
    }

    updateOfficeEnemies() {
        document.getElementById('visual-L').style.display = (this.lights.L && this.entities.Bonnie.pos === 'OFFICE') ? 'block' : 'none';
        document.getElementById('visual-R').style.display = (this.lights.R && (this.entities.Chica.pos === 'OFFICE' || this.entities.Freddy.pos === 'OFFICE')) ? 'block' : 'none';
    }

    toggleMonitor() {
        this.mon = !this.mon;
        document.getElementById('camera-monitor').style.display = this.mon ? 'block' : 'none';
        if(this.mon) this.updateCam();
    }

    setCam(id, btn) {
        this.cam = id;
        document.querySelectorAll('.cam-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        this.updateCam();
    }

    updateCam() {
        const camImg = document.getElementById('cam-image');
        camImg.src = ""; // Reseta imagem
        this.freddyLocked = false;

        // Foxy na 1C
        if(this.cam === '1C') {
            camImg.src = 'foxy.png';
            camImg.style.filter = `brightness(${0.2 + (this.foxyStage * 0.2)})`;
            return;
        }

        for(let key in this.entities) {
            let e = this.entities[key];
            if(e.pos === this.cam) {
                camImg.src = e.img;
                if(key === 'Freddy') this.freddyLocked = true;
            }
        }
    }

    aiTick() {
        // Lógica Foxy (Se não olhar pra 1C, ele avança)
        if(this.cam !== '1C') {
            this.foxyStage++;
            if(this.foxyStage > 4) {
                if(!this.doors.L) this.jumpscare('foxy.png');
                else { this.foxyStage = 0; this.pwr -= 5; } // Bate na porta
            }
        }

        // Lógica Freddy (Trava se estiver sendo olhado pelo monitor)
        if(this.mon && this.freddyLocked) return;

        for(let key in this.entities) {
            let e = this.entities[key];
            if(Math.random() > 0.5) {
                let idx = e.path.indexOf(e.pos);
                if(idx < e.path.length - 1) {
                    e.pos = e.path[idx+1];
                } else {
                    let side = (key === 'Bonnie') ? 'L' : 'R';
                    if(!this.doors[side]) this.jumpscare(e.img);
                    else { e.pos = '1A'; } // Volta ao início
                }
            }
        }
        if(this.mon) this.updateCam();
        this.updateOfficeEnemies();
    }

    jumpscare(img) {
        const overlay = document.getElementById('jumpscare-overlay');
        const imgEl = document.getElementById('scare-img');
        overlay.style.display = 'flex';
        imgEl.src = img;
        setTimeout(() => location.reload(), 2000);
    }
}

const game = new FNAF();
</script>
</body>
</html>
