<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FNAF: Ultimate Mobile Edition</title>
<link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
<style>
    /* ... (Mantenho seu CSS base e adiciono os novos estilos abaixo) ... */
    body { margin: 0; background: #000; color: #fff; font-family: 'VT323', monospace; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
    #screen-container { position: relative; width: 1000px; height: 600px; background: #050505; border: 10px solid #222; overflow: hidden; }
    
    /* Efeito de Scanline para parecer TV antiga */
    #screen-container::after {
        content: " "; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 118, 0.06));
        background-size: 100% 4px, 3px 100%; pointer-events: none; z-index: 2000;
    }

    #office { position: absolute; inset: 0; background: #1a1a1a; display: flex; justify-content: space-between; align-items: center; }
    
    /* Animatr么nicos na Porta - Visual "Sombra" */
    .scary-shadow {
        font-size: 180px; filter: brightness(0.1) drop-shadow(0 0 10px red);
        position: absolute; bottom: 50px; transition: 0.3s;
    }

    /* Ajuste do Monitor para ser escuro */
    #cam-view { background: #020202; }
    #cam-image { display: none; } /* Removida a imagem da montanha */
    
    /* Visual Assustador nas C芒meras */
    #animatronic-visual { 
        position: absolute; font-size: 120px; 
        filter: grayscale(1) contrast(2) brightness(0.5) drop-shadow(0 0 15px #ff0000);
        text-shadow: 5px 5px 0px #000;
    }

    #menu { background: black; text-align: center; gap: 5px; }
    .menu-btn:hover { background: red; color: black; }
    .night-6-btn { border-color: red; color: red; display: none; } /* S贸 aparece se vencer a 5 */

    /* ... (Mantenho as outras classes de bot玫es e portas do c贸digo anterior) ... */
    .door { position: absolute; top: 0; width: 120px; height: 100%; background: #111; z-index: 50; transition: 0.2s; border: 4px solid #000; }
    #door-L { left: 0; transform: translateY(-100%); }
    #door-R { right: 0; transform: translateY(-100%); }
    .closed { transform: translateY(0) !important; }
</style>
</head>
<body>

<div id="screen-container">
    <div id="office">
        <div id="visual-L" class="scary-shadow" style="left: 120px; display:none;"></div>
        <div id="visual-R" class="scary-shadow" style="right: 120px; display:none;"></div>
        
        <div id="door-L" class="door"></div>
        <div id="door-R" class="door"></div>
        
        <div id="light-L" class="light-effect" style="position: absolute; left: 0; width: 300px; height: 100%; background: rgba(255,255,255,0.05); opacity: 0;"></div>
        <div id="light-R" class="light-effect" style="position: absolute; right: 0; width: 300px; height: 100%; background: rgba(255,255,255,0.05); opacity: 0;"></div>

        <div class="side-panel" style="left: 130px;">
            <button class="btn" onclick="game.toggleDoor('L')">DOOR</button>
            <button class="btn" onclick="game.toggleLight('L')">LIGHT</button>
        </div>
        <div class="side-panel" style="right: 130px;">
            <button class="btn" onclick="game.toggleDoor('R')">DOOR</button>
            <button class="btn" onclick="game.toggleLight('R')">LIGHT</button>
        </div>
    </div>

    <div id="camera-monitor" style="display:none; position:absolute; inset:0; background:black; z-index:500;">
        <div id="cam-view" style="width:100%; height:100%; position:relative;">
            <div id="static" style="position:absolute; inset:0; background:url('https://media.giphy.com/media/oEI9uWUuW9nNe/giphy.gif'); opacity:0.1;"></div>
            <div id="animatronic-visual"></div>
            <div id="map">
                <button class="cam-btn" style="top:10px; left:40%" onclick="game.setCam('1A', this)">1A</button>
                <button class="cam-btn" style="top:90px; left:5%" onclick="game.setCam('1C', this)">1C</button>
                <button class="cam-btn" style="bottom:20px; right:25%" onclick="game.setCam('4B', this)">4B</button>
                </div>
        </div>
    </div>

    <div id="ui" style="position:absolute; bottom:20px; left:20px;">POWER: <span id="pwr-val">100</span>%</div>
    <div id="monitor-trigger" style="position:absolute; bottom:0; left:30%; width:40%; height:40px; cursor:pointer; text-align:center; color:white; border: 1px solid white;">MONITOR</div>

    <div id="clock-container" style="position:absolute; top:10px; right:10px; text-align:right;">
        <div id="clock">12:00 AM</div>
        <div id="night-display">Night 1</div>
    </div>

    <div id="menu">
        <h1 style="color:red; font-size:60px;">FNAF: ULTIMATE</h1>
        <button onclick="game.startNewGame()" class="menu-btn">NEW GAME</button>
        <button id="btn-continue" onclick="game.continueGame()" class="menu-btn">CONTINUE</button>
        <button id="btn-night6" onclick="game.startNight(6)" class="menu-btn night-6-btn">NIGHT 6</button>
    </div>

    <div id="jumpscare-overlay" style="display:none; position:fixed; inset:0; background:black; z-index:9999; justify-content:center; align-items:center; flex-direction:column;">
        <div id="scare-char" style="font-size:400px; filter: contrast(2) brightness(0.8);"></div>
        <h1 style="color:red; font-size:80px;">GAME OVER</h1>
    </div>
</div>

<script>
class FNAF {
    constructor() {
        this.timers = [];
        this.isRunning = false;
        this.night = 1;
        this.pwr = 100;
        this.hour = 0;
        this.mon = false;
        this.cam = '1A';
        this.doors = { L: false, R: false };
        this.lights = { L: false, R: false };
        
        this.entities = {
            'Bonnie': { pos: '1A', path: ['1A','1B','5','2A','2B','DOOR'], icon: '', chance: 0.1 },
            'Chica': { pos: '1A', path: ['1A','1B','7','4A','4B','DOOR'], icon: '', chance: 0.08 },
            'Freddy': { pos: '1A', path: ['1A','1B','7','4A','4B','DOOR'], icon: '', chance: 0.05 },
            'Foxy': { progress: 0, icon: '' }
        };

        this.checkSave();
    }

    checkSave() {
        const saved = localStorage.getItem('fnaf_save');
        if (saved) {
            this.night = parseInt(saved);
            if (this.night > 5) document.getElementById('btn-night6').style.display = 'block';
        }
    }

    startNewGame() {
        this.night = 1;
        this.startNight(1);
    }

    continueGame() {
        this.startNight(this.night);
    }

    startNight(nightNum) {
        this.night = nightNum;
        this.pwr = 100;
        this.hour = 0;
        this.isRunning = true;
        document.getElementById('menu').style.display = 'none';
        document.getElementById('night-display').innerText = `Night ${this.night}`;
        
        // Dificuldade baseada na noite
        const mult = 1 + (this.night * 0.2);
        this.entities.Bonnie.chance = 0.1 * mult;
        this.entities.Chica.chance = 0.08 * mult;
        this.entities.Freddy.chance = 0.05 * mult;

        this.gameLoop();
    }

    gameLoop() {
        // Energia
        this.timers.push(setInterval(() => {
            let usage = 1 + (this.doors.L?1:0) + (this.doors.R?1:0) + (this.mon?1:0);
            this.pwr -= 0.15 * usage;
            document.getElementById('pwr-val').innerText = Math.floor(this.pwr);
            if(this.pwr <= 0) this.jumpscare('Freddy');
        }, 1000));

        // Rel贸gio
        this.timers.push(setInterval(() => {
            this.hour++;
            document.getElementById('clock').innerText = `${this.hour}:00 AM`;
            if(this.hour >= 6) this.win();
        }, 50000)); // 50 segundos por hora

        // IA
        this.timers.push(setInterval(() => this.aiTick(), 4000 - (this.night * 300)));
    }

    aiTick() {
        if(!this.isRunning) return;

        // Bonnie, Chica, Freddy
        for(let name in this.entities) {
            if(name === 'Foxy') {
                if(!this.mon && Math.random() < 0.1) {
                    this.entities.Foxy.progress++;
                    if(this.entities.Foxy.progress >= 4) {
                        if(!this.doors.L) this.jumpscare('Foxy');
                        else { this.entities.Foxy.progress = 0; this.pwr -= 5; }
                    }
                }
                continue;
            }

            const e = this.entities[name];
            if(Math.random() < e.chance) {
                let idx = e.path.indexOf(e.pos);
                if(idx < e.path.length - 1) {
                    e.pos = e.path[idx+1];
                } else {
                    // Est谩 na porta
                    const side = (name === 'Bonnie') ? 'L' : 'R';
                    if(!this.doors[side]) this.jumpscare(name);
                    else e.pos = '1A'; // Volta se porta fechada
                }
            }
        }
        this.updateVisuals();
    }

    updateVisuals() {
        // Nas c芒meras
        const display = document.getElementById('animatronic-visual');
        display.innerHTML = '';
        for(let name in this.entities) {
            if(this.entities[name].pos === this.cam) {
                display.innerHTML += this.entities[name].icon;
            }
        }

        // Luzes e Portas (Bonnie e Chica aparecem na luz)
        const bonnieVisible = this.entities.Bonnie.pos === 'DOOR' && this.lights.L;
        const chicaVisible = this.entities.Chica.pos === 'DOOR' && this.lights.R;
        
        document.getElementById('visual-L').style.display = bonnieVisible ? 'block' : 'none';
        document.getElementById('visual-R').style.display = chicaVisible ? 'block' : 'none';
        
        // Freddy e Foxy NO aparecem na luz (Mec芒nica solicitada)
    }

    toggleDoor(side) {
        this.doors[side] = !this.doors[side];
        document.getElementById(`door-${side}`).classList.toggle('closed', this.doors[side]);
    }

    toggleLight(side) {
        this.lights[side] = !this.lights[side];
        document.getElementById(`light-${side}`).style.opacity = this.lights[side] ? 1 : 0;
        this.updateVisuals();
    }

    toggleMonitor() {
        this.mon = !this.mon;
        document.getElementById('camera-monitor').style.display = this.mon ? 'block' : 'none';
    }

    setCam(id, btn) {
        this.cam = id;
        this.updateVisuals();
    }

    jumpscare(who) {
        this.isRunning = false;
        this.timers.forEach(t => clearInterval(t));
        document.getElementById('scare-char').innerText = this.entities[who]?.icon || '';
        document.getElementById('jumpscare-overlay').style.display = 'flex';
        setTimeout(() => location.reload(), 3000);
    }

    win() {
        this.isRunning = false;
        this.timers.forEach(t => clearInterval(t));
        alert("6 AM");
        if(this.night < 6) this.night++;
        localStorage.setItem('fnaf_save', this.night);
        location.reload();
    }
}

const game = new FNAF();
// Trigger do monitor
document.getElementById('monitor-trigger').onclick = () => game.toggleMonitor();
</script>
</body>
</html>

